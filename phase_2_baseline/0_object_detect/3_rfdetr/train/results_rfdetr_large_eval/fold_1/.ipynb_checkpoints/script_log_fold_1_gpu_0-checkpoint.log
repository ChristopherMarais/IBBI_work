2025-06-01 15:39:07 - Fold-1 - INFO - Initializing training for Fold 1 on effective target: GPU 0.
2025-06-01 15:39:07 - Fold-1 - INFO - --- Starting Annotation Validation ---
2025-06-01 15:39:07 - Fold-1 - INFO - Validating COCO annotations file: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/train/_annotations.coco.json
2025-06-01 15:39:08 - Fold-1 - INFO - Found 124389 annotations and 39359 images in /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/train/_annotations.coco.json.
2025-06-01 15:39:09 - Fold-1 - INFO - CATEGORY ID CHECK: IDs found in /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/train/_annotations.coco.json range from 0 to 1 (inclusive). Total unique category IDs found: 2. 
2025-06-01 15:39:09 - Fold-1 - WARNING - USER ACTION: Ensure this maximum ID (1) is compatible with the RFDETRLarge model's expected number of classes. If the model expects N classes (typically 0 to N-1), a max_cat_id of 1 implies at least 2 classes are needed. A mismatch is a common cause of CUDA errors during model initialization.
2025-06-01 15:39:09 - Fold-1 - INFO - Annotation file /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/train/_annotations.coco.json passed basic structural validation checks.
2025-06-01 15:39:09 - Fold-1 - INFO - Validating COCO annotations file: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid/_annotations.coco.json
2025-06-01 15:39:09 - Fold-1 - INFO - Found 30955 annotations and 9840 images in /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid/_annotations.coco.json.
2025-06-01 15:39:10 - Fold-1 - INFO - CATEGORY ID CHECK: IDs found in /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid/_annotations.coco.json range from 0 to 1 (inclusive). Total unique category IDs found: 2. 
2025-06-01 15:39:10 - Fold-1 - WARNING - USER ACTION: Ensure this maximum ID (1) is compatible with the RFDETRLarge model's expected number of classes. If the model expects N classes (typically 0 to N-1), a max_cat_id of 1 implies at least 2 classes are needed. A mismatch is a common cause of CUDA errors during model initialization.
2025-06-01 15:39:10 - Fold-1 - INFO - Annotation file /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid/_annotations.coco.json passed basic structural validation checks.
2025-06-01 15:39:10 - Fold-1 - INFO - --- Annotation Validation Passed (basic structural checks completed) ---
2025-06-01 15:39:10 - Fold-1 - INFO - Base data directory for RFDETR for this fold: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1
2025-06-01 15:39:10 - Fold-1 - INFO - Custom eval will use VALIDATION images from: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid
2025-06-01 15:39:10 - Fold-1 - INFO - Custom eval will use VALIDATION annotations from: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1/valid/_annotations.coco.json
2025-06-01 15:39:10 - Fold-1 - INFO - RFDETR library's native stdout/stderr redirected to: ./results_rfdetr_large_eval/fold_1/rfdetr_library_output_fold_1_gpu_0.log
2025-06-01 15:39:10 - Fold-1 - INFO - Set CUDA_VISIBLE_DEVICES='0' for RFDETR context.
2025-06-01 15:39:10 - Fold-1 - INFO - Set DDP-like env vars: MASTER_ADDR=localhost, PORT=29500, RANK=0, WORLD_SIZE=1, LOCAL_RANK=0
2025-06-01 15:39:10 - Fold-1 - INFO - PyTorch active device context set to: cuda:0 (Logical, maps to physical GPU 0).
2025-06-01 15:39:10 - Fold-1 - INFO - RFDETRLarge.__init__ will likely attempt to initialize model on device type: 'cuda'.
2025-06-01 15:39:10 - Fold-1 - INFO - The .train() method will later be called with device parameter: 'cuda:0'.
2025-06-01 15:39:10 - Fold-1 - WARNING - USER ACTION REQUIRED: Re-check the 'max category_id' logged by the annotation validator. If this ID is out of bounds for the number of classes your RFDETRLarge model expects (especially if pre-trained), it's a VERY COMMON cause of CUDA asserts during model initialization (e.g., when creating embedding layers or classification heads).
2025-06-01 15:39:10 - Fold-1 - INFO - DEBUG TIP: If your RFDETRLarge library allows it (e.g., via an argument like RFDETRLarge(checkpoint_path=None) or RFDETRLarge(load_pretrained_weights=False)), try initializing the model *without* its pre-trained weights. If the error disappears, the issue is likely with the checkpoint file itself (corruption, incompatibility).
2025-06-01 15:39:23 - Fold-1 - INFO - Successfully called RFDETRLarge() constructor.
2025-06-01 15:39:23 - Fold-1 - WARNING - Could not access model_rf.model.parameters() to determine device. Structure might be different.
2025-06-01 15:39:23 - Fold-1 - INFO - Starting RFDETR native training with parameters for its .train() method: {'epochs': 3, 'batch_size': 1, 'grad_accum_steps': 32, 'lr': 0.0001, 'dataset_dir': '/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/coco_rfdetr/coco/cv_iteration_1', 'output_dir': './results_rfdetr_large_eval/fold_1/rfdetr_training_output', 'device': 'cuda:0'}
