Starting rtdetr 5-Fold Training Script
Job ID: 3772921
Running on host: c1107a-s23.ufhpc
Assigned GPUs: 0,1,2
Current working directory: /blue/hulcr/gmarais/PhD/IBBI_work/phase_2_baseline/0_object_detect/8_rtdetr/train
Activating conda environment: EEL
Conda environment activated.
Python version: Python 3.11.10
PyTorch version: 2.5.1+cu124
CUDA available to PyTorch: True
Number of GPUs PyTorch sees: 3
Changed directory to: /blue/hulcr/gmarais/PhD/IBBI_work/phase_2_baseline/0_object_detect/8_rtdetr/train
Running Python script: rtdetr_5fold.py
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Starting RT-DETR training script. Ultralytics version: unknown (torch.hub.ultralytics not found), PyTorch version: 2.5.1+cu124
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Ensure 'rtdetr-x.pt' is accessible and you are in the correct Conda environment ('EEL' based on original paths).
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Starting 5-fold cross-validation training orchestrator for rtdetr-x.pt...
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Base results directory set to: ./results_rtdetr-x
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Data path template: /blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_{}
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Using model: rtdetr-x.pt
2025-05-27 07:57:04 - MainProcess - INFO - MainProcess: Global Training Hyperparameters (see TRAIN_HYPERPARAMS in script for full list): epochs=3, batch=16, imgsz=640
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: PyTorch detects 3 available CUDA GPU(s).
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: GPU 0: NVIDIA A100-SXM4-80GB
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: GPU 1: NVIDIA A100-SXM4-80GB
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: GPU 2: NVIDIA A100-SXM4-80GB
2025-05-27 07:57:05 - MainProcess - WARNING - MainProcess: Requested 5 folds, but only 3 GPU(s) are detected. Folds will be assigned to available GPUs cyclically.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: GPU assignments for folds (Fold Index -> Assigned GPU ID or 'CPU'):
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess:   Fold 1 (0-indexed: 0) --> GPU 0
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess:   Fold 2 (0-indexed: 1) --> GPU 1
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess:   Fold 3 (0-indexed: 2) --> GPU 2
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess:   Fold 4 (0-indexed: 3) --> GPU 0
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess:   Fold 5 (0-indexed: 4) --> GPU 1
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Preparing to launch training process Fold-1_GPU-0 for Fold 1 on GPU/Device '0'.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Preparing to launch training process Fold-2_GPU-1 for Fold 2 on GPU/Device '1'.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Preparing to launch training process Fold-3_GPU-2 for Fold 3 on GPU/Device '2'.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Preparing to launch training process Fold-4_GPU-0 for Fold 4 on GPU/Device '0'.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Preparing to launch training process Fold-5_GPU-1 for Fold 5 on GPU/Device '1'.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Starting 5 training processes...
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Process Fold-1_GPU-0 (PID: 1040715) has been started.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Process Fold-2_GPU-1 (PID: 1040716) has been started.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Process Fold-3_GPU-2 (PID: 1040717) has been started.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Process Fold-4_GPU-0 (PID: 1040718) has been started.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: Process Fold-5_GPU-1 (PID: 1040719) has been started.
2025-05-27 07:57:05 - MainProcess - INFO - MainProcess: All training processes have been launched. Waiting for them to complete...
WARNING ‚ö†Ô∏è Error decoding JSON from /home/gmarais/.config/Ultralytics/settings.json. Starting with an empty dictionary.
Creating new Ultralytics Settings v0.0.6 file ‚úÖ 
View Ultralytics Settings with 'yolo settings' or at '/home/gmarais/.config/Ultralytics/settings.json'
Update Settings with 'yolo settings key=value', i.e. 'yolo settings runs_dir=path/to/dir'. For help see https://docs.ultralytics.com/quickstart/#ultralytics-settings.
Creating new Ultralytics Settings v0.0.6 file ‚úÖ 
View Ultralytics Settings with 'yolo settings' or at '/home/gmarais/.config/Ultralytics/settings.json'
Update Settings with 'yolo settings key=value', i.e. 'yolo settings runs_dir=path/to/dir'. For help see https://docs.ultralytics.com/quickstart/#ultralytics-settings.
WARNING ‚ö†Ô∏è Error decoding JSON from /home/gmarais/.config/Ultralytics/settings.json. Starting with an empty dictionary.
Creating new Ultralytics Settings v0.0.6 file ‚úÖ 
View Ultralytics Settings with 'yolo settings' or at '/home/gmarais/.config/Ultralytics/settings.json'
Update Settings with 'yolo settings key=value', i.e. 'yolo settings runs_dir=path/to/dir'. For help see https://docs.ultralytics.com/quickstart/#ultralytics-settings.
2025-05-27 07:57:07 - Fold-2_GPU-1 - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
2025-05-27 07:57:07 - Fold-3_GPU-2 - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
2025-05-27 07:57:07 - Fold-4_GPU-0 - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
2025-05-27 07:57:07 - Fold-1_GPU-0 - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
2025-05-27 07:57:07 - Fold-5_GPU-1 - INFO - MainProcess: Multiprocessing start method configured to 'spawn'. Current method: spawn
New https://pypi.org/project/ultralytics/8.3.145 available üòÉ Update with 'pip install -U ultralytics'
New https://pypi.org/project/ultralytics/8.3.145 available üòÉ Update with 'pip install -U ultralytics'
New https://pypi.org/project/ultralytics/8.3.145 available üòÉ Update with 'pip install -U ultralytics'
New https://pypi.org/project/ultralytics/8.3.145 available üòÉ Update with 'pip install -U ultralytics'
New https://pypi.org/project/ultralytics/8.3.145 available üòÉ Update with 'pip install -U ultralytics'
Ultralytics 8.3.139 üöÄ Python-3.11.10 torch-2.5.1+cu124 CUDA:0 (NVIDIA A100-SXM4-80GB, 81154MiB)
[34m[1mengine/trainer: [0magnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=50, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_1/data.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=3, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.5, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.0001, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=rtdetr-x.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=rtdetr-x_e3_b16_imgsz640, nbs=64, nms=False, opset=None, optimize=False, optimizer=AdamW, overlap_mask=True, patience=0, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=./results_rtdetr-x/fold_1, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=results_rtdetr-x/fold_1/rtdetr-x_e3_b16_imgsz640, save_frames=False, save_json=False, save_period=1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=True, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0001, workers=3, workspace=None

Ultralytics 8.3.139 üöÄ Python-3.11.10 torch-2.5.1+cu124 CUDA:0 (NVIDIA A100-SXM4-80GB, 81154MiB)
Ultralytics 8.3.139 üöÄ Python-3.11.10 torch-2.5.1+cu124 CUDA:1 (NVIDIA A100-SXM4-80GB, 81154MiB)
Ultralytics 8.3.139 üöÄ Python-3.11.10 torch-2.5.1+cu124 CUDA:1 (NVIDIA A100-SXM4-80GB, 81154MiB)
Ultralytics 8.3.139 üöÄ Python-3.11.10 torch-2.5.1+cu124 CUDA:2 (NVIDIA A100-SXM4-80GB, 81154MiB)
[34m[1mengine/trainer: [0magnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=50, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_4/data.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=3, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.5, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.0001, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=rtdetr-x.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=rtdetr-x_e3_b16_imgsz640, nbs=64, nms=False, opset=None, optimize=False, optimizer=AdamW, overlap_mask=True, patience=0, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=./results_rtdetr-x/fold_4, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=results_rtdetr-x/fold_4/rtdetr-x_e3_b16_imgsz640, save_frames=False, save_json=False, save_period=1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=True, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0001, workers=3, workspace=None

[34m[1mengine/trainer: [0magnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=50, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_5/data.yaml, degrees=0.0, deterministic=True, device=1, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=3, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.5, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.0001, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=rtdetr-x.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=rtdetr-x_e3_b16_imgsz640, nbs=64, nms=False, opset=None, optimize=False, optimizer=AdamW, overlap_mask=True, patience=0, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=./results_rtdetr-x/fold_5, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=results_rtdetr-x/fold_5/rtdetr-x_e3_b16_imgsz640, save_frames=False, save_json=False, save_period=1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=True, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0001, workers=3, workspace=None
[34m[1mengine/trainer: [0magnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=50, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_3/data.yaml, degrees=0.0, deterministic=True, device=2, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=3, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.5, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.0001, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=rtdetr-x.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=rtdetr-x_e3_b16_imgsz640, nbs=64, nms=False, opset=None, optimize=False, optimizer=AdamW, overlap_mask=True, patience=0, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=./results_rtdetr-x/fold_3, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=results_rtdetr-x/fold_3/rtdetr-x_e3_b16_imgsz640, save_frames=False, save_json=False, save_period=1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=True, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0001, workers=3, workspace=None
[34m[1mengine/trainer: [0magnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=50, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=/blue/hulcr/gmarais/PhD/IBBI_work/phase_1_data/2_object_detection_phase_2/ultralytics/cv_iteration_2/data.yaml, degrees=0.0, deterministic=True, device=1, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=3, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.5, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.0001, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=rtdetr-x.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=rtdetr-x_e3_b16_imgsz640, nbs=64, nms=False, opset=None, optimize=False, optimizer=AdamW, overlap_mask=True, patience=0, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=./results_rtdetr-x/fold_2, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=results_rtdetr-x/fold_2/rtdetr-x_e3_b16_imgsz640, save_frames=False, save_json=False, save_period=1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=True, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0001, workers=3, workspace=None



2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Process Fold-1_GPU-0 (PID: 1040715) for Fold 1 has completed. Exit code: 1.
2025-05-27 07:57:10 - MainProcess - ERROR - MainProcess: Process Fold-1_GPU-0 for Fold 1 (PID: 1040715) exited with a non-zero code (1). Check its dedicated log files in ./results_rtdetr-x/fold_1 and the main error output if any.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Process Fold-2_GPU-1 (PID: 1040716) for Fold 2 has completed. Exit code: 1.
2025-05-27 07:57:10 - MainProcess - ERROR - MainProcess: Process Fold-2_GPU-1 for Fold 2 (PID: 1040716) exited with a non-zero code (1). Check its dedicated log files in ./results_rtdetr-x/fold_2 and the main error output if any.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Process Fold-3_GPU-2 (PID: 1040717) for Fold 3 has completed. Exit code: 1.
2025-05-27 07:57:10 - MainProcess - ERROR - MainProcess: Process Fold-3_GPU-2 for Fold 3 (PID: 1040717) exited with a non-zero code (1). Check its dedicated log files in ./results_rtdetr-x/fold_3 and the main error output if any.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Process Fold-4_GPU-0 (PID: 1040718) for Fold 4 has completed. Exit code: 1.
2025-05-27 07:57:10 - MainProcess - ERROR - MainProcess: Process Fold-4_GPU-0 for Fold 4 (PID: 1040718) exited with a non-zero code (1). Check its dedicated log files in ./results_rtdetr-x/fold_4 and the main error output if any.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Process Fold-5_GPU-1 (PID: 1040719) for Fold 5 has completed. Exit code: 1.
2025-05-27 07:57:10 - MainProcess - ERROR - MainProcess: Process Fold-5_GPU-1 for Fold 5 (PID: 1040719) exited with a non-zero code (1). Check its dedicated log files in ./results_rtdetr-x/fold_5 and the main error output if any.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: All 5-fold cross-validation training tasks have finished processing for rtdetr-x.pt.
2025-05-27 07:57:10 - MainProcess - INFO - MainProcess: Please check individual fold directories under ./results_rtdetr-x for detailed logs and training results.
Python script finished.
End of Slurm job.
